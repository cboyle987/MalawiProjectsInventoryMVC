@model List<MalawiProjectsInventoryMVC.ViewModels.ItemQrCodeViewModel>
@using QRCoder
@inject IWebHostEnvironment env

@functions {
    string GenerateBase64Qr(string content)
    {
        using var qrGenerator = new QRCodeGenerator();
        using var qrData = qrGenerator.CreateQrCode(content, QRCodeGenerator.ECCLevel.Q);
        using var qrCode = new PngByteQRCode(qrData);
        var qrBytes = qrCode.GetGraphic(20);
        return "data:image/png;base64," + Convert.ToBase64String(qrBytes);
    }
}

<h1>QR Codes for @ViewBag.DonorName (@ViewBag.DonationDate.ToShortDateString())</h1>
<button class="btn btn-primary my-3" onclick="window.print()">  <i class="bi bi-printer"></i> Print QR Codes</button>

<div class="qr-grid">
    @foreach (var item in Model)
    {
        <div class="qr-box">
            <p><strong>@item.Description</strong></p>
            <img src="@GenerateBase64Qr(item.QrCodeUrl)" />
        </div>
    }
</div>
